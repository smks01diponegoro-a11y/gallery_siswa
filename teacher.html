<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galeri Guru</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .gallery {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    .item {
      background: white;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      width: 220px;
      text-align: center;
      position: relative;
    }
    .item img {
      width: 100%;
      border-radius: 8px;
    }
    .hapus {
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 5px;
    }
    .like {
      background: #007bff;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 5px;
    }
    .comment-section {
      margin-top: 10px;
      text-align: left;
    }
    .comment {
      background: #f3f3f3;
      padding: 5px;
      border-radius: 5px;
      margin-top: 3px;
      font-size: 14px;
    }
    input.comment-input {
      width: 100%;
      padding: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <h1>Galeri Karya Siswa</h1>
  <div class="gallery" id="gallery"></div>

  <script>
    const gallery = document.getElementById('gallery');
    let karya = JSON.parse(localStorage.getItem('karyaSiswa') || '[]');
    let likes = JSON.parse(localStorage.getItem('likesData') || '{}');
    let comments = JSON.parse(localStorage.getItem('commentsData') || '{}');

    if (karya.length === 0) {
      gallery.innerHTML = "<p>Belum ada karya yang diupload.</p>";
    } else {
      karya.forEach((k, i) => {
        const div = document.createElement('div');
        div.classList.add('item');
        div.innerHTML = `
          <img src="${k.img}" alt="Karya ${k.nama}">
          <p><b>${k.nama}</b><br>${k.kelas}</p>
          <button class="like" onclick="likeGambar(${i})">‚ù§Ô∏è Like (${likes[i] || 0})</button>
          <button class="hapus" onclick="hapusGambar(${i})">üóë Hapus</button>
          <div class="comment-section">
            <input type="text" class="comment-input" placeholder="Tulis komentar..." onkeypress="tambahKomentar(event, ${i})">
            <div id="comments-${i}">
              ${(comments[i] || []).map(c => `<div class='comment'>${c}</div>`).join('')}
            </div>
          </div>
        `;
        gallery.appendChild(div);
      });
    }

    function likeGambar(index) {
      if (localStorage.getItem('liked-' + index)) {
        alert("Kamu sudah like gambar ini!");
        return;
      }
      likes[index] = (likes[index] || 0) + 1;
      localStorage.setItem('likesData', JSON.stringify(likes));
      localStorage.setItem('liked-' + index, true);
      location.reload();
    }

    function hapusGambar(index) {
      if (confirm("Yakin mau hapus gambar ini?")) {
        karya.splice(index, 1);
        localStorage.setItem('karyaSiswa', JSON.stringify(karya));
        location.reload();
      }
    }

    function tambahKomentar(event, index) {
      if (event.key === 'Enter') {
        const input = event.target;
        const komentar = input.value.trim();
        if (komentar) {
          if (!comments[index]) comments[index] = [];
          comments[index].push(komentar);
          localStorage.setItem('commentsData', JSON.stringify(comments));
          input.value = '';
          location.reload();
        }
      }
    }
  </script>

</body>
</html>
